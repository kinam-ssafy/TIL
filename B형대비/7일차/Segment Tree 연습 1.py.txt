# 세그먼트 트리 초기화
def init(node, nodeLeft, nodeRight):
    if nodeLeft == nodeRight:
        maxTree[node] = a[nodeLeft]
        minTree[node] = a[nodeLeft]
        return

    mid = (nodeLeft + nodeRight) // 2

    init(node * 2, nodeLeft, mid)
    init(node * 2 + 1, mid + 1, nodeRight)

    maxTree[node] = max(maxTree[node * 2], maxTree[node * 2 + 1])
    minTree[node] = min(minTree[node * 2], minTree[node * 2 + 1])

# 세그먼트 트리 갱신
def update(node, nodeLeft, nodeRight, queryIndex, value):
    if queryIndex < nodeLeft or nodeRight < queryIndex:
        return

    if nodeLeft == nodeRight:
        maxTree[node] = value
        minTree[node] = value
        return

    mid = (nodeLeft + nodeRight) // 2

    update(node * 2, nodeLeft, mid, queryIndex, value)
    update(node * 2 + 1, mid + 1, nodeRight, queryIndex, value)

    maxTree[node] = max(maxTree[node * 2], maxTree[node * 2 + 1])
    minTree[node] = min(minTree[node * 2], minTree[node * 2 + 1])

# 최대값 쿼리
def queryMax(node, nodeLeft, nodeRight, queryLeft, queryRight):
    if queryRight < nodeLeft or nodeRight < queryLeft:
        return 0

    if queryLeft <= nodeLeft and nodeRight <= queryRight:
        return maxTree[node]

    mid = (nodeLeft + nodeRight) // 2

    leftMax = queryMax(node * 2, nodeLeft, mid, queryLeft, queryRight)
    rightMax = queryMax(node * 2 + 1, mid + 1, nodeRight, queryLeft, queryRight)

    return max(leftMax, rightMax)


# 최소값 쿼리
def queryMin(node, nodeLeft, nodeRight, queryLeft, queryRight):
    if queryRight < nodeLeft or nodeRight < queryLeft:
        return 1000000000000

    if queryLeft <= nodeLeft and nodeRight <= queryRight:
        return minTree[node]

    mid = (nodeLeft + nodeRight) // 2

    leftMin = queryMin(node * 2, nodeLeft, mid, queryLeft, queryRight)
    rightMin = queryMin(node * 2 + 1, mid + 1, nodeRight, queryLeft, queryRight)

    return min(leftMin, rightMin)

t = int(input())

for test in range(1, t + 1):
    print(f'#{test} ', end='')

    n, m = map(int, input().split())
    a = list(map(int, input().split()))

    maxTree = [0 for _ in range(4 * n)]
    minTree = [0 for _ in range(4 * n)]

    init(1, 0, n - 1)

    for i in range(m):
        query, left, right = map(int, input().split())

        if query == 0:
            update(1, 0, n - 1, left, right)
        elif query == 1:
            maxVal = queryMax(1, 0, n - 1, left, right - 1)
            minVal = queryMin(1, 0, n - 1, left, right - 1)
            print(maxVal - minVal, end=' ')

    print()