MAX_MAKE_LIST = 10
MAX_LENGTH = 200000
MAX_ADDRESS = 6000
MAX_CHANGE = 110000

def init():
    global initNumber, initValue
    global addressNumber, address
    global changeNumber, changeLog
    global lastChange, prevChange

    initNumber = 0  # 만들어진 배열의 개수
    initValue = [[] for _ in range(MAX_MAKE_LIST + 1)]  # 초기 배열 정보

    addressNumber = 0   # 존재하는 배열의 개수
    address = {}        # key: 배열 이름, value: 원본 배열의 번호

    changeNumber = 0    # 변화 개수
    changeLog = [[0, 0] for _ in range(MAX_CHANGE + 1)]      # 모든 변화 기록을 담는 배열
    # makeList         : (-1, 원본 배열 번호)
    # copyList         : (-1, -1) 정보 추가하기. (deepcopy를 의미함)
    # updateElement    : (인덱스, 값) ; 인덱스의 값을 변경했다.


    lastChange = [0 for _ in range(MAX_ADDRESS + 1)]    # lastChange[i] := i번 원본 배열의 마지막 변화 event 번호
    prevChange = [0 for _ in range(MAX_CHANGE + 1)]     # prevChange[i] := i번 변화의 직전 변화 event 번호

def makeList(mName, mLength, mListValue):
    global initNumber, addressNumber, changeNumber

    initValue[initNumber] = mListValue.copy()

    address[mName] = addressNumber
    addressNumber += 1

    changeLog[changeNumber] = [-1, initNumber]
    prevChange[changeNumber] = -1
    lastChange[address[mName]] = changeNumber
    changeNumber += 1

    initNumber += 1

def copyList(mDest, mSrc, mCopy):   # O(1)
    global addressNumber, changeNumber

    if mCopy:
        address[mDest] = addressNumber
        addressNumber += 1

        changeLog[changeNumber] = [-1, -1]
        prevChange[changeNumber] = lastChange[address[mSrc]]
        lastChange[address[mDest]] = changeNumber
        changeNumber += 1
    else:
        address[mDest] = address[mSrc]

def updateElement(mName, mIndex, mValue):   # O(1)
    global changeNumber

    changeLog[changeNumber] = [mIndex, mValue]
    prevChange[changeNumber] = lastChange[address[mName]]
    lastChange[address[mName]] = changeNumber
    changeNumber += 1

def element(mName, mIndex):     # O(update 횟수)
    c = lastChange[address[mName]]
    while True:
        if prevChange[c] == -1:     # 이전 변화가 없다면, 최초 makeList이다.
            return initValue[changeLog[c][1]][mIndex]
        if changeLog[c][0] == mIndex:       # mIndex 가 직접 update 된 적이 있다.
            return changeLog[c][1]
        c = prevChange[c]

    return 0